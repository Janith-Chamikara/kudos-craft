pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                echo 'Getting code...'
                checkout scm
            }
        }

        stage('Parallel Builds') {
            parallel {
                // --- Job 1: Backend ---
                stage('Backend Build') {
                    steps {
                        dir('backend') {
                            echo 'Installing backend dependencies...'
                            sh 'npm install --network-timeout 1000000'
                            
                            echo 'Building backend...'
                            sh 'npm run build'
                        }
                    }
                }

                // // --- Job 2: Frontend ---
                // stage('Frontend Build') {
                //     steps {
                //         dir('frontend') {
                //             echo 'Installing frontend dependencies...'
                //             sh 'npm install --legacy-peer-deps'
                            
                //             echo 'Building frontend...'
                //             sh 'npm run build'
                //         }
                //     }
                // }
            }
        }
    }
}